window.__require=function t(e,n,o){function r(a,c){if(!n[a]){if(!e[a]){var p=a.split("/");if(p=p[p.length-1],!e[p]){var u="function"==typeof __require&&__require;if(!c&&u)return u(p,!0);if(i)return i(p,!0);throw new Error("Cannot find module '"+a+"'")}}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){return r(e[a][1][t]||t)},l,l.exports,t,e,n,o)}return n[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<o.length;a++)r(o[a]);return r}({AnimLabel:[function(t,e,n){"use strict";cc._RF.push(e,"e78cfI7rUxCS4HLhV3m0Lsw","AnimLabel");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=(i.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.animLabel=null,e.currentValue=0,e}return o(e,t),e.prototype.onLoad=function(){this.label=cc.find("label",this.node),this.animLabel=cc.find("animLabel",this.node)},e.prototype.setColor=function(t){this.animLabel.color=t},e.prototype.setValue=function(t,e){var n=e.prefix,o=void 0===n?"":n,r=e.subfix,i=void 0===r?"":r,a=e.animate,c=void 0===a||a,p=t-this.currentValue;this.currentValue&&c&&p&&(p>0?this.setColor(cc.Color.GREEN):this.setColor(cc.Color.RED),this.animLabel.getComponent(cc.Label).string=p>0?"+"+p:""+p,this.playAnim()),this.currentValue=t,this.label.getComponent(cc.Label).string=""+o+t+i},e.prototype.playAnim=function(t){var e=this;void 0===t&&(t=.3);var n=cc.sequence(cc.spawn(cc.fadeIn(t),cc.moveBy(t,cc.v2(0,40))),cc.spawn(cc.fadeOut(t),cc.moveBy(t,cc.v2(0,40))),cc.callFunc(function(){e.animLabel.setPosition(cc.v2(0,0))}));this.animLabel.runAction(n)},e=r([a],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],Enemy:[function(t,e,n){"use strict";cc._RF.push(e,"638d0IW3ZlBRr5Gf+Bjp7Fv","Enemy");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=i.property,p=t("./AnimLabel"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enemyNode=null,e.hpLabel=null,e.game=null,e.animation=null,e}return o(e,t),Object.defineProperty(e.prototype,"isAnimPlaying",{get:function(){return this.animation.getAnimationState("hurt").isPlaying||this.animation.getAnimationState("attack").isPlaying},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this.animation=this.getComponent(cc.Animation)},e.prototype.init=function(e){e.maxHp=e.maxHp+2*this.game.level,e.damage=e.damage+(this.game.level-1),t.prototype.init.call(this,e)},e.prototype.start=function(){this.hpLabel.setValue(this._currentHp,{subfix:"hp",animate:!1})},e.prototype.attack=function(){!this.game.enemyRound||this._currentHp<=0||(t.prototype.attack.call(this,this.game.player),this.playAttackAnimation())},e.prototype.damage=function(e){t.prototype.damage.call(this,e),this.playHurtAnimation()},e.prototype.updateStatus=function(){this.hpLabel.setValue(this._currentHp,{subfix:"hp"})},e.prototype.playHurtAnimation=function(){this.animation.play("hurt")},e.prototype.playAttackAnimation=function(){this.animation.play("attack")},r([c(cc.Node)],e.prototype,"enemyNode",void 0),r([c(p.default)],e.prototype,"hpLabel",void 0),e=r([a],e)}(t("./GameObject").default);n.default=u,cc._RF.pop()},{"./AnimLabel":"AnimLabel","./GameObject":"GameObject"}],GameObject:[function(t,e,n){"use strict";cc._RF.push(e,"56ebem/8p1HpqXUv81CEpE7","GameObject");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._maxHp=25,e._currentHp=0,e._damage=5,e}return o(e,t),Object.defineProperty(e.prototype,"isDead",{get:function(){return this._currentHp<=0},enumerable:!0,configurable:!0}),e.prototype.init=function(t){this._currentHp=this._maxHp=t.maxHp,this._damage=t.damage},e.prototype.attack=function(t){t.damage(this._damage),this.updateStatus()},e.prototype.damage=function(t){this._currentHp=Math.max(0,this._currentHp-t),this.updateStatus()},e.prototype.updateStatus=function(){},e}(cc.Component);n.default=r,cc._RF.pop()},{}],Game:[function(t,e,n){"use strict";cc._RF.push(e,"e1b90/rohdEk4SdmmEZANaD","Game");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var i,a=t("./Enemy"),c=t("./Player"),p=cc._decorator,u=p.ccclass,l=p.property;(function(t){t[t.Enemy=1]="Enemy",t[t.Player=2]="Player"})(i||(i={}));var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enemyNode=null,e.playerNode=null,e.nextRoomButton=null,e.bg=null,e.levelLabel=null,e.roundLabel=null,e.level=1,e.player=null,e.enemy=null,e._round=i.Player,e}return o(e,t),Object.defineProperty(e.prototype,"playerRound",{get:function(){return this._round===i.Player},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enemyRound",{get:function(){return this._round===i.Enemy},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this.player=this.playerNode.getComponent(c.default),this.player.game=this,this.player.init(window.cfg.player),this.enemy=this.enemyNode.getComponent(a.default),this.enemy.game=this,this.enemy.init(window.cfg.enemy)},e.prototype.checkEnemyRound=function(){var t=this;this.player.runOutAp&&(this._round=i.Enemy,setTimeout(function(){t.enemy.attack(),t.player.resetAp(),t._round=i.Player},800))},e.prototype.nextRoom=function(){this.level++,this.player.incrDamage(),this.levelLabel.string="Level: "+this.level,this.enemy.init(window.cfg.enemy),this.player.resetAp(),this.player.updateStatus(),this.enemy.updateStatus(),this.loadTransition()},e.prototype.loadTransition=function(){var t=this;this.enemyNode.active=!0,this.nextRoomButton.node.active=!1,this.bg.opacity=0;var e=cc.sequence(cc.fadeIn(.8),cc.callFunc(function(){t._round=i.Player}));this.bg.runAction(e)},e.prototype.checkDead=function(){this.player.isDead&&cc.director.loadScene("game")},e.prototype.update=function(){this.enemy&&this.enemy.isDead&&!this.enemy.isAnimPlaying&&(this._round=i.Enemy,this.enemyNode.active=!1,this.nextRoomButton.node.active=!0),this.checkDead(),this.roundLabel.string="Round: "+(this.playerRound?"Player":"Enemy")},r([l(cc.Node)],e.prototype,"enemyNode",void 0),r([l(cc.Node)],e.prototype,"playerNode",void 0),r([l(cc.Button)],e.prototype,"nextRoomButton",void 0),r([l(cc.Node)],e.prototype,"bg",void 0),r([l(cc.Label)],e.prototype,"levelLabel",void 0),r([l(cc.Label)],e.prototype,"roundLabel",void 0),e=r([u],e)}(cc.Component);n.default=s,cc._RF.pop()},{"./Enemy":"Enemy","./Player":"Player"}],Player:[function(t,e,n){"use strict";cc._RF.push(e,"f3b5foslYZHQ6ta98paWGYk","Player");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=i.property,p=t("./AnimLabel"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hpLabel=null,e.apLabel=null,e.mpLabel=null,e.attackBtn=null,e.healBtn=null,e.hintLayer=null,e.hintLabel=null,e._maxAp=3,e._currentAp=0,e._maxMp=10,e._currentMp=0,e._mpRecoveryInterval=2,e._healInterval=8,e.game=null,e}return o(e,t),Object.defineProperty(e.prototype,"runOutAp",{get:function(){return this._currentAp<=0},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this.hintLabel=this.hintLayer.getComponentInChildren(cc.Label),this.attackBtn.node.on("mouseenter",this.mouseEnter("attack"),this),this.attackBtn.node.on("mouseleave",this.mouseLeave,this),this.healBtn.node.on("mouseenter",this.mouseEnter("enter"),this),this.healBtn.node.on("mouseleave",this.mouseLeave,this)},e.prototype.init=function(e){this._currentAp=this._maxAp=e.maxAp,this._currentMp=this._maxMp=e.maxMp,this._healInterval=e.healInterval,this._mpRecoveryInterval=e.mpRecoveryInterval,t.prototype.init.call(this,e)},e.prototype.start=function(){this.hpLabel.setValue(this._currentHp,{prefix:"HP\n",animate:!1}),this.apLabel.setValue(this._currentAp,{prefix:"AP\n",animate:!1}),this.mpLabel.setValue(this._currentMp,{prefix:"MP\n",animate:!1})},e.prototype.heal=function(){if(this.game.playerRound&&!(this._currentMp<=0)){var t=Math.min(this._currentMp,this._healInterval);this._currentHp=Math.min(this._maxHp,this._currentHp+t),this._currentMp-=t,this.updateStatus()}},e.prototype.attack=function(){!this.game.playerRound||this._currentAp<=0||(this._currentAp-=1,this.mpRecovery(),this.game.checkEnemyRound(),t.prototype.attack.call(this,this.game.enemy))},e.prototype.updateStatus=function(){this.hpLabel.setValue(this._currentHp,{prefix:"HP\n"}),this.apLabel.setValue(this._currentAp,{prefix:"AP\n"}),this.mpLabel.setValue(this._currentMp,{prefix:"MP\n"})},e.prototype.resetAp=function(){this._currentAp=this._maxAp,this.updateStatus()},e.prototype.mpRecovery=function(){this._currentMp=Math.min(this._maxMp,this._currentMp+this._mpRecoveryInterval)},e.prototype.mouseEnter=function(t){var e=this;return function(){e.hintLayer.active=!0,e.hintLabel.string="attack"!==t?"Healing, Heals the player for "+e._healInterval+" HP.":"Attack, Deals "+e._damage+" damages to enemy."}},e.prototype.mouseLeave=function(){this.hintLayer.active=!1},e.prototype.incrDamage=function(){this._damage+=1},r([c(p.default)],e.prototype,"hpLabel",void 0),r([c(p.default)],e.prototype,"apLabel",void 0),r([c(p.default)],e.prototype,"mpLabel",void 0),r([c(cc.Button)],e.prototype,"attackBtn",void 0),r([c(cc.Button)],e.prototype,"healBtn",void 0),r([c(cc.Node)],e.prototype,"hintLayer",void 0),e=r([a],e)}(t("./GameObject").default);n.default=u,cc._RF.pop()},{"./AnimLabel":"AnimLabel","./GameObject":"GameObject"}]},{},["AnimLabel","Enemy","Game","GameObject","Player"]);